<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¿ã‚¹ã‚¯ç·¨é›† - æ€ æƒ°æ˜¯æ­£ã‚¢ãƒ—ãƒª</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header>
            <h1 class="app-title">â˜ ï¸ æ€ æƒ°æ˜¯æ­£ã‚¢ãƒ—ãƒª</h1>
            <p class="subtitle">ã‚¿ã‚¹ã‚¯ã‚’ç·¨é›†ã™ã‚‹</p>
            <a href="{{ url_for('index') }}" class="back-link">â† ã‚¿ã‚¹ã‚¯ä¸€è¦§ã«æˆ»ã‚‹</a>
        </header>

        <!-- ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="edit-task-section">
            <form action="{{ url_for('edit_task', task_id=task.id) }}" method="post" class="task-edit-form">
                <div class="form-group">
                    <label>ğŸ“‹ ã‚¿ã‚¹ã‚¯å</label>
                    <input 
                        type="text" 
                        name="task_title" 
                        value="{{ task.title }}" 
                        placeholder="ä¾‹ï¼šæ˜æ—¥ã®1é™ã«å‡ºå¸­ã™ã‚‹" 
                        maxlength="200"
                        required
                    >
                    <small>ç¾åœ¨: {{ task.title }}</small>
                </div>

                <div class="form-group">
                    <label>â° æœŸé™</label>
                    <input 
                        type="datetime-local" 
                        name="deadline"
                        value="{% if task.deadline %}{{ task.deadline.strftime('%Y-%m-%dT%H:%M') }}{% endif %}"
                        required
                    >
                    <small>
                        {% if task.deadline %}
                            ç¾åœ¨: {{ task.deadline.strftime('%Yå¹´%mæœˆ%dæ—¥ %H:%M') }}
                        {% else %}
                            æœŸé™ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“
                        {% endif %}
                    </small>
                </div>

                <div class="form-group">
                    <label style="color: #e74c3c; font-weight: bold;">ğŸ’€ æœŸé™ã‚’å®ˆã‚Œãªã‹ã£ãŸæ™‚ã®æŠ•ç¨¿å†…å®¹</label>
                    <textarea 
                        name="penalty_text" 
                        placeholder="ä¾‹ï¼šä»Šæ—¥ã‚‚ä¸€é™ã«èµ·ãã‚‰ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚æ˜æ—¥å±±ç”°ã«ã”é£¯ã‚’å¥¢ã‚Šã¾ã™ã€‚" 
                        maxlength="500"
                        required
                    >{{ task.penalty_text }}</textarea>
                    <small style="color: #e74c3c;">
                        ã“ã®ãƒ†ã‚­ã‚¹ãƒˆãŒè‡ªå‹•æŠ•ç¨¿ã•ã‚Œã¾ã™ï¼ˆç¾åœ¨: {{ task.penalty_text[:30] }}...ï¼‰
                    </small>
                </div>

                <!-- ã‚¿ã‚¹ã‚¯æƒ…å ±è¡¨ç¤º -->
                <div class="task-info-box">
                    <h3>ğŸ“Œ ã‚¿ã‚¹ã‚¯æƒ…å ±</h3>
                    <div class="info-item">
                        <span class="label">ä½œæˆæ—¥æ™‚:</span>
                        <span class="value">{{ task.created_at.strftime('%Yå¹´%mæœˆ%dæ—¥ %H:%M') }}</span>
                    </div>
                    <div class="info-item">
                        <span class="label">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:</span>
                        <span class="value">
                            {% if task.is_punished %}
                                <span style="color: #e74c3c;">ğŸ’€ æŠ•ç¨¿æ¸ˆã¿</span>
                            {% elif task.is_completed %}
                                <span style="color: #2ecc71;">âœ… å®Œäº†</span>
                            {% else %}
                                <span style="color: #3498db;">â³ é€²è¡Œä¸­</span>
                            {% endif %}
                        </span>
                    </div>
                </div>

                <!-- ãƒœã‚¿ãƒ³ã‚°ãƒ«ãƒ¼ãƒ— -->
                <div class="form-actions">
                    <button type="submit" class="btn-save">ğŸ’¾ æ›´æ–°</button>
                    <a href="{{ url_for('index') }}" class="btn-cancel">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</a>
                </div>
            </form>
        </div>

        <!-- Flashãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div id="flashContainer" class="flash-container">
                    {% for category, message in messages %}
                        <div class="flash-message flash-{{ category }}">
                            <span>{{ message }}</span>
                            <button class="flash-close" onclick="this.parentElement.remove()">&times;</button>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
    </div>

    <style>
        .back-link {
            display: inline-block;
            color: #3498db;
            text-decoration: none;
            margin-top: 15px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .back-link:hover {
            color: #2980b9;
            text-decoration: underline;
        }

        .edit-task-section {
            background-color: #333;
            padding: 30px;
            border-radius: 12px;
            border: 2px solid #e74c3c;
            margin-top: 20px;
            animation: slideInUp 0.3s;
        }

        .task-edit-form {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            color: #ddd;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.05em;
        }

        .form-group input,
        .form-group textarea {
            background-color: #444;
            border: 2px solid #555;
            color: white;
            padding: 12px;
            border-radius: 6px;
            font-size: 1em;
            transition: all 0.3s;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #e74c3c;
            background-color: #484848;
            box-shadow: 0 0 8px rgba(231, 76, 60, 0.3);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-group small {
            color: #aaa;
            font-size: 0.85em;
            margin-top: 8px;
            font-style: italic;
        }

        .task-info-box {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            border-left: 5px solid #3498db;
            margin: 15px 0;
        }

        .task-info-box h3 {
            margin: 0 0 15px 0;
            color: #3498db;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #444;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-item .label {
            color: #aaa;
            font-weight: bold;
        }

        .info-item .value {
            color: #ddd;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .btn-save {
            flex: 1;
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 15px 25px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.4);
        }

        .btn-save:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(231, 76, 60, 0.6);
        }

        .btn-save:active {
            transform: translateY(0);
        }

        .btn-cancel {
            flex: 1;
            background-color: #555;
            color: white;
            border: none;
            padding: 15px 25px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 6px;
            text-decoration: none;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-cancel:hover {
            background-color: #666;
            transform: translateY(-2px);
        }

        .btn-cancel:active {
            transform: translateY(0);
        }

        @media (max-width: 600px) {
            .edit-task-section {
                padding: 20px;
                border-radius: 8px;
            }

            .form-actions {
                flex-direction: column;
            }

            .btn-save,
            .btn-cancel {
                width: 100%;
            }

            .task-info-box {
                margin: 20px 0;
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>

</body>
</html>